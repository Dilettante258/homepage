---
import { SUPPORTED_LOCALES, type Locale } from '../i18n/strings';

type Props = { locale: Locale };
const { locale } = Astro.props;

const buildHref = (target: Locale) => {
	const segments = Astro.url.pathname.split('/').filter(Boolean);
	// ensure locale is always at index 0 when prefixDefaultLocale is on
	if (!segments.length) return `/${target}`;
	segments[0] = target;
	return `/${segments.join('/')}`;
};
---

<div class="switcher" aria-label="Choose language">
	{SUPPORTED_LOCALES.map((code) => (
		<a class={code === locale ? 'active' : ''} href={buildHref(code)}>
			{code.toUpperCase()}
		</a>
	))}
</div>

<style>
	.switcher {
		display: inline-flex;
		gap: 2px;
		border: 1px solid var(--stroke);
		border-radius: 8px;
		padding: 2px;
	}

	.switcher a {
		color: var(--muted);
		text-decoration: none;
		font-weight: 500;
		font-size: 0.8rem;
		padding: 0.3rem 0.6rem;
		border-radius: 6px;
		transition: color 0.15s;
	}

	.switcher a:hover {
		color: var(--text);
	}

	.switcher a.active {
		background: var(--surface-tag);
		color: var(--text);
	}
</style>
