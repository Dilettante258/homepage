---
import type { HTMLAttributes } from "astro/types";
import BaseLayout from "./BaseLayout.astro";
import LanguageSwitcher from "../components/LanguageSwitcher.astro";
import ThemeToggle from "../components/ThemeToggle.astro";
import NavLinks from "../components/NavLinks.astro";
import type { Locale, Messages } from "../i18n/strings";

type Props = {
  locale: Locale;
  t: Messages;
  title?: string;
  description?: string;
} & HTMLAttributes<"main">;

const { locale, t, title, description, ...rest } = Astro.props;
---

<BaseLayout locale={locale} title={title} description={description}>
  <header class="shell header" transition:persist>
    <div class="brand">
      <strong class="brand-name">Yiming</strong>
    </div>
    <NavLinks locale={locale} t={t} />
    <div class="header-actions">
      <LanguageSwitcher locale={locale} />
      <ThemeToggle />
    </div>
  </header>
  <main class="shell content" {...rest}>
    <slot />
  </main>
  <footer class="shell footer" transition:persist>
    <p>{t.footer.note}</p>
  </footer>
</BaseLayout>

<style>
  .shell {
    width: 100%;
    max-width: 1100px;
    margin: 0 auto;
    padding-left: 1.5rem;
    padding-right: 1.5rem;
    position: relative;
    z-index: 1;
  }

  @media (min-width: 640px) {
    .shell {
      padding-left: 2.5rem;
      padding-right: 2.5rem;
    }
  }

  .header {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    padding-top: 1.25rem;
    padding-bottom: 1.25rem;
    position: sticky;
    top: 0;
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    z-index: 10;
  }

  .brand {
    flex-shrink: 0;
  }

  .brand-name {
    font-family: var(--font-heading);
    font-size: 1.2rem;
    font-weight: 400;
    letter-spacing: -0.01em;
  }

  .header-actions {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    flex-shrink: 0;
  }

  .content {
    padding-top: 1rem;
    padding-bottom: 4rem;
  }

  .footer {
    border-top: 1px solid var(--stroke);
    padding-top: 2rem;
    padding-bottom: 3rem;
    color: var(--muted);
    font-size: 13px;
  }

  @media (max-width: 700px) {
    .header {
      flex-wrap: wrap;
    }
  }
</style>
